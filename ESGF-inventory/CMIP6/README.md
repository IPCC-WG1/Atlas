# CMIP6 ATLAS dataset

The management of the dataset involves the following processes:

- Discovering available datasets in ESGF and generation of inventories in csv format.
- Downloading available datasets from ESGF and reporting status of the download.
- Generation on NcMLs.

This is a long process so, when a new update is required, I suggest to work in a specific branch and commit changes after every step of the process. I also suggest to merge with a commit message including the date of the merge and tag the merge commit (ex. `cmip6-2020-06-23`).

## Generation of inventories of datasets available in ESGF

```bash
scripts/CMIP6.sh
```

This creates the inventories `CMIP6_day.json`, `CMIP6_mon.json` and `CMIP6_fx.json`.
Manual revision of these inventories is required and the results should be saved in the file `CMIP6_day_1run.csv`.

The script `scripts/inventory-to-metalink` inspects `CMIP6_day_1run.csv` and generates the corresponding metalink file, used for data download.

## Downloading available datasets from ESGF

Download the selected files from ESGF using aria2c and metalink file. You can check the status of the download in `download-report`, generated by `../esgf-check -m metalink > download-report`.

## Generation of NcMLs

See `scripts/publisher.sh`.
